# 发薪报表演示Demo

## 项目概述

这是一个基于原始Excel报表需求开发的在线报表功能演示，实现了多级表头、列分组、动态展开/收起、数据合计和同期对比等核心功能。

## 功能特性

### 🎯 核心功能

1. **多级表头展示**
   - 完全复刻原始Excel表格的层级结构
   - 支持一级、二级、三级表头的嵌套显示
   - 表头结构：部门 → 发薪人数/工薪成本/奖金 → 各项明细

2. **列分组与动态展开/收起**
   - 默认折叠状态，仅显示一级表头的聚合数据
   - 点击表头旁的"+"/"-"按钮可逐级展开分组
   - 支持"全部展开"和"全部收起"一键操作

3. **数据聚合与计算**
   - 自动计算分组合计值
   - 底部总计行实时更新
   - 数据联动，展开/收起时保持数据一致性

4. **同期对比功能**
   - 支持显示上月数据对比
   - 环比增减计算，用颜色和箭头直观显示变化趋势
   - 可一键切换对比模式的开启/关闭

5. **用户体验优化**
   - 固定表头和部门列，支持大数据量浏览
   - 响应式设计，适配不同屏幕尺寸
   - 基于Arco Design设计规范，界面美观统一

## 技术实现

### 技术栈
- **前端框架**: 原生JavaScript + HTML5 + CSS3
- **UI组件库**: Arco Design CSS样式
- **数据处理**: 纯JavaScript实现
- **样式方案**: CSS3 + Flexbox布局

### 核心算法
- 递归表头生成算法
- 动态列展开/收起算法
- 数据聚合计算算法
- 同期对比计算算法

## 项目结构

```
Payroll Report Demo/
├── index.html          # 主页面文件
├── script.js           # 核心JavaScript逻辑
└── README.md          # 项目说明文档
```

## 快速开始

### 本地运行

1. 克隆或下载项目文件
2. 在项目目录下启动本地服务器：
   ```bash
   python3 -m http.server 8081
   ```
3. 打开浏览器访问：`http://localhost:8081`

### 功能演示

1. **基础浏览**：页面加载后可看到折叠状态的报表
2. **展开操作**：点击表头旁的"+"按钮展开分组
3. **批量操作**：使用"全部展开"/"全部收起"按钮
4. **同期对比**：点击"显示同期对比"查看环比数据

## 数据说明

### 模拟数据
- 包含15个部门的模拟数据
- 自动生成本月和上月的对比数据
- 数据包括发薪人数、工薪成本、奖金等维度

### 表头结构
```
部门
├── 发薪人数
│   ├── 加班人数
│   └── 劳动补偿金支付人数
├── 工薪成本
│   ├── 应发工资
│   │   └── 本月调薪额度
│   ├── 五险一金司付
│   │   ├── 社会保险
│   │   └── 住房公积金
│   └── 其他工薪科目
│       ├── 离职补偿金
│       ├── 加班费
│       └── 签约金
└── 奖金
```

## 浏览器兼容性

- Chrome 60+
- Firefox 55+
- Safari 12+
- Edge 79+

## 开发说明

### 扩展功能
如需添加新的功能，可以在以下方面进行扩展：

1. **数据源集成**：替换模拟数据为真实API接口
2. **权限控制**：添加用户认证和数据权限控制
3. **导出功能**：支持Excel、PDF等格式导出
4. **图表展示**：集成图表库显示数据趋势

### 自定义样式
项目使用Arco Design的CSS样式，可以通过修改CSS变量来自定义主题：

```css
:root {
  --primary-color: #165dff;
  --success-color: #00b42a;
  --danger-color: #f53f3f;
}
```

## 版本历史

- **v1.0.0** (2024-12-19)
  - 初始版本发布
  - 实现多级表头和列分组功能
  - 支持动态展开/收起
  - 添加同期对比功能

## 许可证

MIT License

## 联系方式

如有问题或建议，请联系开发团队。