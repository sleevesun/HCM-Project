1. 文档概述
文档目的: 本文档旨在详细描述将提供的Excel表格转换为线上报表功能的产品需求。

版本信息: V1.4

编写人: Gemini

2. 功能需求
2.1 整体功能目标
将原始Excel报表数据结构化并实现在线展示，核心功能是支持多级表头和列分组的动态显示，用户可以根据需要展开或收起次要数据列，从而提升报表的可读性和数据分析效率。同时，新增同期对比功能，帮助用户更好地分析数据变化。

2.2 功能模块与详细需求
2.2.1 报表主视图
多级表头展示: 报表应完全复刻原始Excel表格的层级结构。具体表头结构如下：

一级表头 (核心分类): “部门”、“发薪人数”、“工薪成本”、“奖金”。

二级表头:

发薪人数 下级：包含“加班人数”和“劳动补偿金支付人数”。

工薪成本 下级：包含“应发工资”、“五险一金司付”和“其他工薪科目”。

三级表头:

应发工资 下级：包含“本月调薪额度”。

五险一金司付 下级：包含“社会保险”和“住房公积金”（这两项在原始表格中对应I列）。

其他工薪科目 下级：包含“离职补偿金”、“加班费”和“签约金”。

表头布局与合并:

“L”型布局: 表头应采用类似“L”型合并的布局。上级表头单元格会向下和向右合并，形成一个包围下级表头的结构。

“发薪人数”表头示例: 假设表头占据第1至3行，发薪人数数据占据B至D列：

“发薪人数”：占据 B1, C1, D1, B2, B3 单元格。

“加班人数”：占据 C2, C3 单元格。

“劳动补偿金支付人数”：占据 D2, D3 单元格。

数据展示: 报表应能正确加载和展示Excel表格中的所有数据，包括各部门在上述所有列维度下的具体数值。

固定表头与列: 报表应支持固定左侧的“部门”列，以便用户在水平滚动时也能清楚地看到部门信息。同时，顶部的多级表头也应固定，方便用户垂直滚动时查看。

响应式设计: 报表应具备良好的响应式设计，能在不同尺寸的屏幕上（桌面、平板、手机）正常显示，但主要设计以桌面端为主。

2.2.2 列分组与动态展开/收起
分组依据: 报表的列分组应基于各级父表头，实现层级展开。例如：“发薪人数”分组，包含其下的二级列。

分组默认状态:

折叠状态: 默认情况下，所有二级和三级明细列都应隐藏，只显示所有一级表头的聚合列（例如，“发薪人数”列）和非展开项（例如，“部门”、“奖金”）。

展开状态: 用户通过点击父表头旁的交互元素来展开分组。展开时，父表头本身不消失，而是向右侧动态新增其下属的明细列。

交互方式:

点击展开/收起: 在各级父表头的单元格中，添加一个可点击的交互元素（如“+”/“-”图标）。

点击“+”时，向右侧新增显示其所有下属明细列。

点击“-”时，隐藏所有下属明细列，只保留父表头聚合列。

全部展开/收起: 在报表上方或表头区域，提供一个“全部展开”/“全部收起”的按钮，方便用户一键控制所有分组的显示状态。

2.2.3 数据聚合与计算
分组合计: 在默认折叠状态下，各级父表头列（如“发薪人数”、“工薪成本”）本身即为聚合列，显示其下属所有明细数据的合计值。

总计行: 在报表底部，第37行固定为“总计”，用于对所有部门的数据进行求和汇总。

数据联动: 当用户展开或收起分组时，报表中的其他相关数据（如总计行）应能随之动态更新，保持数据的一致性。

2.2.4 同期对比功能 (基于V1.2，无改动)
功能目标: 在报表视图中，为“发薪人数”和“工薪成本”这两大核心数据提供与上月数据的对比展示。

展示方式:

默认展示: 在“发薪人数”和“工薪成本”的列中，默认显示本月数据。

对比模式: 在报表顶部或工具栏提供一个切换按钮（如“显示同期对比”），点击后在相应列下新增两列，用于展示：

上月数据: 显示上个月的对应数据。

环比增减: 显示本月数据相较于上月数据的环比增减额（或百分比）。增涨数据用绿色字体显示，下降数据用红色字体显示。

交互: 用户可以通过点击切换按钮，随时开启或关闭同期对比视图。当对比模式开启时，可以保持原有的列分组展开/收起功能，所有二级、三级明细数据都应同步展示本月、上月和环比数据。

2.3 权限与数据安全
登录认证: 用户需要通过身份认证才能访问报表。

数据权限: 根据用户的角色和权限，控制其可以查看的部门和数据范围。

3. 页面原型与交互设计
页面布局: 采用经典的报表布局，左侧为部门列，右侧为数据列。

交互元素:

一级/二级父表头旁放置“+”/“-”图标，点击后切换展开/收起状态。

报表顶部或工具栏放置“全部展开”/“全部收起”按钮，以及新增的“显示同期对比”切换按钮。

视觉效果:

展开/收起时的动画效果，使交互更流畅。

不同层级的表头和分组应有明显的视觉区分，例如通过颜色、背景或边框来区分。

环比增减数据应使用不同颜色和图标（例如向上/向下箭头）来直观地表示变化趋势。

4. 关键指标与成功标准
用户体验: 报表的加载速度快，交互流畅，用户能快速理解如何展开/收起数据和切换同期对比。

数据准确性: 报表展示的数据与原始Excel数据和上月数据完全一致，计算结果准确无误。

功能完整性: 成功实现多级表头、列分组、动态展开/收起、数据合计和同期对比等核心功能。